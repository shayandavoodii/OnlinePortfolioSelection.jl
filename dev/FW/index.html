<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Follow the Winner · OnlinePortfolioSelection.jl</title><meta name="title" content="Follow the Winner · OnlinePortfolioSelection.jl"/><meta property="og:title" content="Follow the Winner · OnlinePortfolioSelection.jl"/><meta property="twitter:title" content="Follow the Winner · OnlinePortfolioSelection.jl"/><meta name="description" content="Documentation for OnlinePortfolioSelection.jl."/><meta property="og:description" content="Documentation for OnlinePortfolioSelection.jl."/><meta property="twitter:description" content="Documentation for OnlinePortfolioSelection.jl."/><meta property="og:url" content="https://shayandavoodii.github.io/OnlinePortfolioSelection.jl/FW/"/><meta property="twitter:url" content="https://shayandavoodii.github.io/OnlinePortfolioSelection.jl/FW/"/><link rel="canonical" href="https://shayandavoodii.github.io/OnlinePortfolioSelection.jl/FW/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="OnlinePortfolioSelection.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">OnlinePortfolioSelection.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../fetchdata/">Fetch Financial Data</a></li><li><a class="tocitem" href="../python/">Use In Python</a></li><li><span class="tocitem">OPS Strategies</span><ul><li><a class="tocitem" href="../benchmark/">Benchmark</a></li><li><a class="tocitem" href="../FL/">Follow the Loser</a></li><li class="is-active"><a class="tocitem" href>Follow the Winner</a><ul class="internal"><li><a class="tocitem" href="#Universal-Portfolio"><span>Universal Portfolio</span></a></li><li><a class="tocitem" href="#Exponential-Gradient"><span>Exponential Gradient</span></a></li><li><a class="tocitem" href="#Price-Peak-Tracking-(PPT)"><span>Price Peak Tracking (PPT)</span></a></li></ul></li><li><a class="tocitem" href="../PM/">Pattern-Matching</a></li><li><a class="tocitem" href="../ML/">Meta-Learning</a></li><li><a class="tocitem" href="../Combined/">Combined Strategies</a></li></ul></li><li><a class="tocitem" href="../performance_eval/">Performance Evaluation</a></li><li><a class="tocitem" href="../funcs/">Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">OPS Strategies</a></li><li class="is-active"><a href>Follow the Winner</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Follow the Winner</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/shayandavoodii/OnlinePortfolioSelection.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/shayandavoodii/OnlinePortfolioSelection.jl/blob/main/docs/src/FW.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Follow-the-Winner-(FW)"><a class="docs-heading-anchor" href="#Follow-the-Winner-(FW)">Follow the Winner (FW)</a><a id="Follow-the-Winner-(FW)-1"></a><a class="docs-heading-anchor-permalink" href="#Follow-the-Winner-(FW)" title="Permalink"></a></h1><p>The Follow the Winner (FW) strategies operate on the principle that assets that have shown superior performance in the past are likely to continue excelling in the future. In this package, the following FW strategies have been implemented:</p><ol><li>Universal Portfolio (UP)</li><li>Exponential Gradient (EG)</li><li>Price Peak Tracking (PPT)</li></ol><h2 id="Universal-Portfolio"><a class="docs-heading-anchor" href="#Universal-Portfolio">Universal Portfolio</a><a id="Universal-Portfolio-1"></a><a class="docs-heading-anchor-permalink" href="#Universal-Portfolio" title="Permalink"></a></h2><p>Universal Portfolio (UP) is a Follow the Winner (FW) strategy introduced by <a href="https://doi.org/10.1111/j.1467-9965.1991.tb00002.x">Cover (1991)</a>. This algorithm is designed to optimize the cumulative return of a portfolio over the investment horizon. UP&#39;s approach is centered on daily stock market performance and the distribution of wealth invested in individual stocks.</p><p>See <a href="../funcs/#OnlinePortfolioSelection.up-Tuple{Matrix{Float64}}"><code>up</code></a>.</p><h3 id="Run-UP"><a class="docs-heading-anchor" href="#Run-UP">Run UP</a><a id="Run-UP-1"></a><a class="docs-heading-anchor-permalink" href="#Run-UP" title="Permalink"></a></h3><p><strong>Note:</strong> This package is meant to be used by researchers <strong>NOT FOR MARKET PRACTITIONERS</strong>. Let&#39;s run the algorithm on the real market data. The data is collected as noted in the <a href="../fetchdata/#Fetch-Data">Fetch Data</a> section.</p><pre><code class="language-julia hljs">juila&gt; using OnlinePortfolioSelection

julia&gt; size(prices)
(17, 5)

# OnlinePortfolioSelection suppose that the data is in the form of a matrix
# where each row is the price vector of the assets at a specific time period.
julia&gt; prices = prices |&gt; permutedims;

# Let&#39;s run the algorithm on the last 5 days of the data.
julia&gt; m_up = up(prices[:, end-4:end], eval_points=100);

juila&gt; m_up.b
5×5 Matrix{Float64}:
 0.2  0.216518  0.216638  0.21681   0.216542
 0.2  0.203395  0.203615  0.203754  0.203528
 0.2  0.191899  0.191793  0.192316  0.192473
 0.2  0.193023  0.192302  0.191687  0.19208
 0.2  0.195164  0.195652  0.195433  0.195377</code></pre><p>One can calculate the cumulative wealth during the investment period by using the <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}} where T&lt;:AbstractFloat"><code>sn</code></a> function:</p><pre><code class="language-julia hljs">julia&gt; rel_price = prices[:, 2:end] ./ prices[:, 1:end-1];

julia&gt; sn(m_up.b, rel_price)
6-element Vector{Float64}:
 1.0
 0.9879822623031318
 0.9856240412854884
 0.9874863498385578
 0.9778277061434468
 0.9718529924971879</code></pre><p>The outcome shows that if we had invested during that period, we would have incurred a loss of approximately 2.8% in wealth. It&#39;s important to note that <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}} where T&lt;:AbstractFloat"><code>sn</code></a> automatically considers the last 5 relative prices in this context. Let&#39;s now examine the algorithm&#39;s performance using various significant metrics.</p><pre><code class="language-julia hljs">julia&gt; results = OPSMetrics(m_up.b, rel_price)

            Cumulative Return: 0.972
                          APY: -0.763
Annualized Standard Deviation: 0.088
      Annualized Sharpe Ratio: -8.857
             Maximum Drawdown: 0.028
                 Calmar Ratio: -27.101

julia&gt; results.
APY         Ann_Sharpe  Ann_Std     Calmar      MDD         Sn

julia&gt; results.MDD
0.02814700750281207</code></pre><p>It is worht mentioning that each metric can be accessed individually by writing <code>results.</code> and pressing <code>Tab</code> key. Note that one can individually investigate the performance of the algorithm regarding each metric. See <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}} where T&lt;:AbstractFloat"><code>sn</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_std-Tuple{AbstractVector{&lt;:AbstractFloat}}"><code>ann_std</code></a>, <a href="../funcs/#OnlinePortfolioSelection.apy-Union{Tuple{S}, Tuple{AbstractFloat, S}} where S&lt;:Int64"><code>apy</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_sharpe-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:AbstractFloat"><code>ann_sharpe</code></a>, <a href="../funcs/#OnlinePortfolioSelection.mdd-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>mdd</code></a>, and <a href="../funcs/#OnlinePortfolioSelection.calmar-Union{Tuple{T}, Tuple{T, T}} where T&lt;:AbstractFloat"><code>calmar</code></a>. See <a href="../performance_eval/#Performance-evaluation">Performance evaluation</a> section for more information.</p><h2 id="Exponential-Gradient"><a class="docs-heading-anchor" href="#Exponential-Gradient">Exponential Gradient</a><a id="Exponential-Gradient-1"></a><a class="docs-heading-anchor-permalink" href="#Exponential-Gradient" title="Permalink"></a></h2><p>Exponential Gradient (EG) is a FW strategy introduced by <a href="https://onlinelibrary.wiley.com/doi/10.1111/1467-9965.00058">Helmbold et al. (1998)</a>. The authors assert that EG can nearly attain the same wealth as the best constant rebalanced portfolio (BCRP), discerned retrospectively from the actual market outcomes. This algorithm is notably straightforward to implement.</p><p>See <a href="../funcs/#OnlinePortfolioSelection.eg-Tuple{Matrix{Float64}}"><code>eg</code></a>.</p><h3 id="Run-EG"><a class="docs-heading-anchor" href="#Run-EG">Run EG</a><a id="Run-EG-1"></a><a class="docs-heading-anchor-permalink" href="#Run-EG" title="Permalink"></a></h3><p>Let&#39;s run the algorithm on the real market data. The data is collected as noted in the &quot;<a href="../fetchdata/#Fetch-Data">Fetch-Data</a>&quot; section.</p><pre><code class="language-julia hljs">juila&gt; using OnlinePortfolioSelection

julia&gt; size(prices)
(17, 5)

# OnlinePortfolioSelection suppose that the data is in the form of a matrix
# where each row is the price vector of the assets at a specific time period.
julia&gt; prices = prices |&gt; permutedims;

# Let&#39;s run the algorithm on the last 5 days of the data.
julia&gt; m_eg = eg(prices[:, end-4:end], eta=0.02);

juila&gt; m_eg.b
5×5 Matrix{Float64}:
 0.2  0.200001  0.200016  0.20003   0.199997
 0.2  0.200049  0.200073  0.200087  0.200064
 0.2  0.19999   0.199973  0.200029  0.200051
 0.2  0.199937  0.199846  0.19978   0.199827
 0.2  0.200023  0.200092  0.200074  0.200061 </code></pre><p>One can calculate the cumulative wealth during the investment period by using the <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}} where T&lt;:AbstractFloat"><code>sn</code></a> function:</p><pre><code class="language-julia hljs">julia&gt; rel_price = prices[:, 2:end] ./ prices[:, 1:end-1];

julia&gt; sn(m_eg.b, rel_price)
6-element Vector{Float64}:
 1.0
 0.9879822623031318
 0.9854825989102248
 0.98713136445759
 0.9773624367829401
 0.9716549466747438</code></pre><p>The outcome suggests that if we had invested during the given period, we would have incurred a loss of approximately 2.8% of our wealth. It&#39;s important to note that <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}} where T&lt;:AbstractFloat"><code>sn</code></a> automatically considers the last 5 relative prices in this case. Let&#39;s proceed to investigate the algorithm&#39;s performance using key metrics.</p><pre><code class="language-julia hljs">julia&gt; results = OPSMetrics(m_eg.b, rel_price)

            Cumulative Return: 0.972
                          APY: -0.765
Annualized Standard Deviation: 0.087
      Annualized Sharpe Ratio: -9.005
             Maximum Drawdown: 0.028
                 Calmar Ratio: -26.9

julia&gt; results.
APY         Ann_Sharpe  Ann_Std     Calmar      MDD         Sn

julia&gt; results.MDD
0.028345053325256164</code></pre><p>It is worht mentioning that each metric can be accessed individually by writing <code>results.</code> and pressing the <code>Tab</code> key. Note that one can individually investigate the performance of the algorithm regarding each metric. See <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}} where T&lt;:AbstractFloat"><code>sn</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_std-Tuple{AbstractVector{&lt;:AbstractFloat}}"><code>ann_std</code></a>, <a href="../funcs/#OnlinePortfolioSelection.apy-Union{Tuple{S}, Tuple{AbstractFloat, S}} where S&lt;:Int64"><code>apy</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_sharpe-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:AbstractFloat"><code>ann_sharpe</code></a>, <a href="../funcs/#OnlinePortfolioSelection.mdd-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>mdd</code></a>, and <a href="../funcs/#OnlinePortfolioSelection.calmar-Union{Tuple{T}, Tuple{T, T}} where T&lt;:AbstractFloat"><code>calmar</code></a>. See <a href="../performance_eval/#Performance-evaluation">Performance evaluation</a> section for more information.</p><h2 id="Price-Peak-Tracking-(PPT)"><a class="docs-heading-anchor" href="#Price-Peak-Tracking-(PPT)">Price Peak Tracking (PPT)</a><a id="Price-Peak-Tracking-(PPT)-1"></a><a class="docs-heading-anchor-permalink" href="#Price-Peak-Tracking-(PPT)" title="Permalink"></a></h2><p>The Price Peak Tracking (PPT) algorithm (<a href="https://doi.org/10.1109/TNNLS.2017.2705658">Lai et al., 2017</a>) is a novel linear learning system for online portfolio selection, based on the idea of tracking control. The algorithm uses a transform function that aggressively tracks the increasing power of different assets, and allocates more investment to the better performing ones. The PPT objective can be solved by a fast backpropagation algorithm, which is suitable for large-scale and time-limited applications, such as high-frequency trading. The algorithm has been shown to outperform other state-of-the-art systems in computational time, cumulative wealth, and risk-adjusted metrics (See <a href="../funcs/#OnlinePortfolioSelection.ppt"><code>ppt</code></a>).</p><p>Let&#39;s run the algorithm on the real market data.</p><pre><code class="language-julia hljs">julia&gt; using OnlinePortfolioSelection, YFinance

julia&gt; tickers = [&quot;AAPL&quot;, &quot;AMZN&quot;, &quot;GOOG&quot;, &quot;MSFT&quot;];

julia&gt; querry = [get_prices(ticker, startdt=&quot;2019-01-01&quot;, enddt=&quot;2020-01-01&quot;)[&quot;adjclose&quot;] for ticker in tickers];

julia&gt; prices = stack(querry) |&gt; permutedims;

julia&gt; model = ppt(prices, 10, 100, 100);

julia&gt; model.b
4×100 Matrix{Float64}:
 0.25  1.0  0.999912    0.999861    …  0.0         0.0       
 0.25  0.0  2.92288e-5  4.63411e-5     1.00237e-8  9.72784e-9
 0.25  0.0  2.92288e-5  4.63411e-5     1.0         1.0
 0.25  0.0  2.92288e-5  4.63411e-5     0.0         0.0</code></pre><p>One can calculate the cumulative wealth during the investment period by using the <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}} where T&lt;:AbstractFloat"><code>sn</code></a> function:</p><pre><code class="language-julia hljs">julia&gt; rel_price = prices[:, 2:end] ./ prices[:, 1:end-1];

julia&gt; sn(model.b, rel_price)
101-element Vector{Float64}:
 1.0
 0.9888797685444782
 0.9863705003355839
 ⋮
 1.250897464327529
 1.2363240910685966
 1.2371383272398555</code></pre><p>The outcome suggests that if we had invested during the given period, we would have incurred a loss of approximately 2.8% of our wealth. It&#39;s important to note that <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}} where T&lt;:AbstractFloat"><code>sn</code></a> automatically considers the last 5 relative prices in this case. Let&#39;s proceed to investigate the algorithm&#39;s performance using key metrics.</p><pre><code class="language-julia hljs">julia&gt; results = OPSMetrics(model.b, rel_price)

            Cumulative Return: 1.2371383272398555
        Mean Excessive Return: -0.15974968844419762
  Annualized Percentage Yield: 0.709598073342651
Annualized Standard Deviation: 0.1837958159802144
      Annualized Sharpe Ratio: 3.751979171369636
             Maximum Drawdown: 0.04210405543971303
                 Calmar Ratio: 16.853437654211092

julia&gt; results.MER
-0.15974968844419762</code></pre><p>It is worht mentioning that each metric can be accessed individually by writing <code>results.</code> and pressing the <code>Tab</code> key. Note that one can individually investigate the performance of the algorithm regarding each metric. See <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}} where T&lt;:AbstractFloat"><code>sn</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_std-Tuple{AbstractVector{&lt;:AbstractFloat}}"><code>ann_std</code></a>, <a href="../funcs/#OnlinePortfolioSelection.apy-Union{Tuple{S}, Tuple{AbstractFloat, S}} where S&lt;:Int64"><code>apy</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_sharpe-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:AbstractFloat"><code>ann_sharpe</code></a>, <a href="../funcs/#OnlinePortfolioSelection.mdd-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>mdd</code></a>, and <a href="../funcs/#OnlinePortfolioSelection.calmar-Union{Tuple{T}, Tuple{T, T}} where T&lt;:AbstractFloat"><code>calmar</code></a>. See <a href="../performance_eval/#Performance-evaluation">Performance evaluation</a> section for more information.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../FL/">« Follow the Loser</a><a class="docs-footer-nextpage" href="../PM/">Pattern-Matching »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 7 November 2023 17:24">Tuesday 7 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
