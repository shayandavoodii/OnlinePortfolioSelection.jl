<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Meta-Learning · OnlinePortfolioSelection.jl</title><meta name="title" content="Meta-Learning · OnlinePortfolioSelection.jl"/><meta property="og:title" content="Meta-Learning · OnlinePortfolioSelection.jl"/><meta property="twitter:title" content="Meta-Learning · OnlinePortfolioSelection.jl"/><meta name="description" content="Documentation for OnlinePortfolioSelection.jl."/><meta property="og:description" content="Documentation for OnlinePortfolioSelection.jl."/><meta property="twitter:description" content="Documentation for OnlinePortfolioSelection.jl."/><meta property="og:url" content="https://shayandavoodii.github.io/OnlinePortfolioSelection.jl/ML/"/><meta property="twitter:url" content="https://shayandavoodii.github.io/OnlinePortfolioSelection.jl/ML/"/><link rel="canonical" href="https://shayandavoodii.github.io/OnlinePortfolioSelection.jl/ML/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="OnlinePortfolioSelection.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">OnlinePortfolioSelection.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../fetchdata/">Fetch Financial Data</a></li><li><a class="tocitem" href="../python/">Use In Python</a></li><li><span class="tocitem">OPS Strategies</span><ul><li><a class="tocitem" href="../benchmark/">Benchmark</a></li><li><a class="tocitem" href="../FL/">Follow the Loser</a></li><li><a class="tocitem" href="../FW/">Follow the Winner</a></li><li><a class="tocitem" href="../PM/">Pattern-Matching</a></li><li class="is-active"><a class="tocitem" href>Meta-Learning</a><ul class="internal"><li><a class="tocitem" href="#Combination-Weights-based-on-Online-Gradient-Descent-(CW-OGD)"><span>Combination Weights based on Online Gradient Descent (CW-OGD)</span></a></li><li><a class="tocitem" href="#Continuous-Aggregating-Exponential-Gradient-(CAEG)"><span>Continuous Aggregating Exponential Gradient (CAEG)</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../Combined/">Combined Strategies</a></li></ul></li><li><a class="tocitem" href="../performance_eval/">Performance Evaluation</a></li><li><a class="tocitem" href="../funcs/">Functions</a></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../refs/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">OPS Strategies</a></li><li class="is-active"><a href>Meta-Learning</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Meta-Learning</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/shayandavoodii/OnlinePortfolioSelection.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/shayandavoodii/OnlinePortfolioSelection.jl/blob/main/docs/src/ML.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Meta-Learning-Strategies-(ML)"><a class="docs-heading-anchor" href="#Meta-Learning-Strategies-(ML)">Meta-Learning Strategies (ML)</a><a id="Meta-Learning-Strategies-(ML)-1"></a><a class="docs-heading-anchor-permalink" href="#Meta-Learning-Strategies-(ML)" title="Permalink"></a></h1><p>Meta-learning strategies are employed to combine opinions from experts to formulate a final portfolio. Each expert&#39;s opinion is represented as a vector of weights summing to one. Subsequently, the performance of each expert is quantified, influencing the final portfolio. Each expert can either be a portfolio optimization model or simply a vector of weights as an input. The following meta-learning strategies are currently implemented in the package:</p><ol><li><a href="#Combination-Weights-based-on-Online-Gradient-Descent-(CW-OGD)">Combination Weights based on Online Gradient Descent (CW-OGD)</a></li><li><a href="#Continuous-Aggregating-Exponential-Gradient-(CAEG)">Continuous Aggregating Exponential Gradient (CAEG)</a></li></ol><h2 id="Combination-Weights-based-on-Online-Gradient-Descent-(CW-OGD)"><a class="docs-heading-anchor" href="#Combination-Weights-based-on-Online-Gradient-Descent-(CW-OGD)">Combination Weights based on Online Gradient Descent (CW-OGD)</a><a id="Combination-Weights-based-on-Online-Gradient-Descent-(CW-OGD)-1"></a><a class="docs-heading-anchor-permalink" href="#Combination-Weights-based-on-Online-Gradient-Descent-(CW-OGD)" title="Permalink"></a></h2><p><a href="../refs/#ZHANG2021107533">Zhang <em>et al.</em> [24]</a> introduced a novel online portfolio selection algorithm leveraging a weighted learning technique and an online gradient descent algorithm. Their strategy demonstrates enhanced robustness by integrating various expert strategies and successfully addresses the challenge of complex computational time. To begin, the authors establish an expert pool encompassing numerous basic expert strategies, among which the strategy investing in a single stock is chosen as the fundamental expert strategy. Subsequently, they employ a loss function to assess the performance of each basic expert strategy and utilize the OGD algorithm to adjust the weight vector for the experts based on their losses.</p><h3 id="Run-CW-OGD"><a class="docs-heading-anchor" href="#Run-CW-OGD">Run CW-OGD</a><a id="Run-CW-OGD-1"></a><a class="docs-heading-anchor-permalink" href="#Run-CW-OGD" title="Permalink"></a></h3><p><strong>Note:</strong> This package is meant to be used by researchers <strong>NOT FOR MARKET PRACTITIONERS</strong>. Let&#39;s run the algorithm on the real market data. (see <a href="../funcs/#OnlinePortfolioSelection.cwogd-Tuple{AbstractMatrix, AbstractFloat, Any}"><code>cwogd</code></a> for more information.)</p><pre><code class="language-julia hljs">julia&gt; using OnlinePortfolioSelection, YFinance

julia&gt; tickers = [&quot;AAPL&quot;, &quot;MSFT&quot;, &quot;GOOG&quot;];

julia&gt; startdt, enddt = &quot;2019-01-01&quot;, &quot;2019-01-10&quot;;

julia&gt; querry_open_price = [get_prices(ticker, startdt=startdt, enddt=enddt)[&quot;open&quot;] for ticker in tickers];

julia&gt; open_pr = reduce(hcat, querry_open_price) |&gt; permutedims;

julia&gt; querry_close_pr = [get_prices(ticker, startdt=startdt, enddt=enddt)[&quot;adjclose&quot;] for ticker in tickers];

julia&gt; close_pr = reduce(hcat, querry_close_pr) |&gt; permutedims;

julia&gt; rel_pr = close_pr ./ open_pr
3×6 Matrix{Float64}:
 1.01956  0.987568  1.02581  0.994822  1.00796   1.01335
 1.01577  0.973027  1.02216  1.00413   0.997671  1.00395
 1.0288   0.976042  1.03692  0.997097  1.00016   0.993538

julia&gt; gamma = 0.1; H = 0.5;

julia&gt; model = cwogd(rel_pr, gamma, H);

julia&gt; model.b
3×5 Matrix{Float64}:
 0.333333  0.351048  0.346241  0.338507  0.350524
 0.333333  0.321382  0.309454  0.320351  0.311853
 0.333333  0.32757   0.344305  0.341142  0.337623</code></pre><p>Now, let&#39;s investiagte the performance of the algorithm according to some of the prominent metrics:</p><pre><code class="language-julia hljs">julia&gt; metrics = opsmetrics(model.b, rel_pr)
            Cumulative Return: 1.0323425490046683
                          APY: 2.8071567518024554
Annualized Standard Deviation: 0.2821163077868604
      Annualized Sharpe Ratio: 9.879459906685577
             Maximum Drawdown: 0.021128559444089628
                 Calmar Ratio: 132.86077355300776

juila&gt; metrics.Sn
7-element Vector{Float64}:
 1.0
 1.0213786603648736
 0.9997984006244297
 1.0282690253184847
 1.0266415196096432
 1.0286957343361505
 1.0323425490046683</code></pre><p>The result indicates that if we had invested in the given period, we would have gained ~3.2% profit. It is worth mentioning that each metric can be accessed individually by writing <code>results.</code> and pressing the <code>Tab</code> key. Note that one can individually investigate the performance of the algorithm regarding each metric. See <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}} where T&lt;:AbstractFloat"><code>sn</code></a>, <a href="../funcs/#OnlinePortfolioSelection.mer-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}, T}} where T&lt;:AbstractFloat"><code>mer</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ir-Union{Tuple{S}, Tuple{AbstractMatrix{S}, AbstractMatrix{S}, AbstractVector{S}}} where S&lt;:AbstractFloat"><code>ir</code></a>, <a href="../funcs/#OnlinePortfolioSelection.apy-Union{Tuple{S}, Tuple{AbstractFloat, S}} where S&lt;:Int64"><code>apy</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_sharpe-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:AbstractFloat"><code>ann_sharpe</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_std-Tuple{AbstractVector{&lt;:AbstractFloat}}"><code>ann_std</code></a>, <a href="../funcs/#OnlinePortfolioSelection.calmar-Union{Tuple{T}, Tuple{T, T}} where T&lt;:AbstractFloat"><code>calmar</code></a>, and <a href="../funcs/#OnlinePortfolioSelection.mdd-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>mdd</code></a>. See <a href="../performance_eval/#Performance-evaluation">Performance evaluation</a> section for more information.</p><h2 id="Continuous-Aggregating-Exponential-Gradient-(CAEG)"><a class="docs-heading-anchor" href="#Continuous-Aggregating-Exponential-Gradient-(CAEG)">Continuous Aggregating Exponential Gradient (CAEG)</a><a id="Continuous-Aggregating-Exponential-Gradient-(CAEG)-1"></a><a class="docs-heading-anchor-permalink" href="#Continuous-Aggregating-Exponential-Gradient-(CAEG)" title="Permalink"></a></h2><p><a href="../refs/#doi:10.1080/01605682.2020.1848358">Xingyu Yang and Zhang [25]</a> presented a new online portfolio strategy that aggregates multiple exponential gradient strategies with different learning rates using the weak aggregating algorithm. The strategy has a universal property that guarantees its average logarithmic growth rate to be the same as the best constant rebalanced portfolio in hindsight. The authors combine the portfolio pool using the following formula:</p><p class="math-container">\[{\mathbf{b}_{t + 1}} = \frac{{\sum\nolimits_{\eta  \in \tilde E} {{\mathbf{b}_{t + 1}}\left( \eta  \right){{\left( {{S_t}\left( \eta  \right)} \right)}^{\frac{1}{{\sqrt {t + 1} }}}}} }}{{\sum\nolimits_{\eta  \in \tilde E} {{{\left( {{S_t}\left( \eta  \right)} \right)}^{\frac{1}{{\sqrt {t + 1} }}}}} }}\]</p><p>where <span>$t$</span> is the today&#39;s index, <span>$\tilde E = \{ {\eta _1},{\eta _2}, \ldots ,{\eta _n}\}$</span> is a set of EG experts with different <span>$\eta$</span> parameters, the cumulative return of the expert <span>$\eta$</span> at time <span>$t$</span> is denoted as <span>${S_t}\left( \eta  \right)$</span>, and the portfolio by expert <span>$\eta$</span> at time <span>$t+1$</span> is represented as <span>$\mathbf{b}_{t + 1}$</span>.</p><h3 id="Run-CAEG"><a class="docs-heading-anchor" href="#Run-CAEG">Run CAEG</a><a id="Run-CAEG-1"></a><a class="docs-heading-anchor-permalink" href="#Run-CAEG" title="Permalink"></a></h3><p>Let&#39;s run the algorithm on the real market data (Also, see <a href="../funcs/#OnlinePortfolioSelection.caeg-Tuple{AbstractMatrix, AbstractVector}"><code>caeg</code></a>):</p><pre><code class="language-julia hljs">julia&gt; using OnlinePortfolioSelection, YFinance

julia&gt; tickers = [&quot;AAPL&quot;, &quot;MSFT&quot;, &quot;GOOG&quot;];

julia&gt; startdt, enddt = &quot;2020-1-1&quot;, &quot;2020-1-10&quot;;

julia&gt; open_querry = [get_prices(ticker, startdt=startdt, enddt=enddt)[&quot;open&quot;] for ticker ∈ tickers];

julia&gt; open_ = stack(open_querry) |&gt; permutedims;

julia&gt; close_querry = [get_prices(ticker, startdt=startdt, enddt=enddt)[&quot;adjclose&quot;] for ticker ∈ tickers];

julia&gt; close_ = stack(close_querry) |&gt; permutedims;

julia&gt; rel_pr = close_./open_;

julia&gt; learning_rates = [0.02, 0.05];

julia&gt; model = caeg(rel_pr, learning_rates);

julia&gt; model.b
3×6 Matrix{Float64}:
 0.333333  0.333322  0.333286  0.333271  0.333287  0.333368
 0.333333  0.333295  0.333271  0.333171  0.333123  0.333076
 0.333333  0.333383  0.333443  0.333558  0.33359   0.333557</code></pre><p>Now, let&#39;s investiagte the performance of the algorithm according to some of the prominent metrics:</p><pre><code class="language-julia hljs">julia&gt; metrics = opsmetrics(model.b, rel_pr)

            Cumulative Return: 1.0503793029297175
        Mean Excessive Return: -0.041332740360267836
  Annualized Percentage Yield: 6.880223548529358
Annualized Standard Deviation: 0.16251944416204514
      Annualized Sharpe Ratio: 42.21170939822534
             Maximum Drawdown: 0.006347966314766578
                 Calmar Ratio: 1083.8468900700761</code></pre><p>The result indicates that if we had invested in the given period, we would have gained ~5% profit. Please check the <a href="../performance_eval/#Performance-evaluation">Performance evaluation</a> section for more information.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><div class="citation noncanonical"><dl><dt>[24]</dt><dd><div>Y. Zhang, H. Lin, X. Yang and W. Long. <em>Combining expert weights for online portfolio selection based on the gradient descent algorithm</em>. <a href="https://doi.org/10.1016/j.knosys.2021.107533">Knowledge-Based Systems <strong>234</strong>, 107533</a> (2021).</div></dd><dt>[25]</dt><dd><div>J. H. Xingyu Yang and Y. Zhang. <em>Aggregating exponential gradient expert advice for online portfolio selection</em>. <a href="https://doi.org/10.1080/01605682.2020.1848358">Journal of the Operational Research Society <strong>73</strong>, 587–597</a> (2020).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../PM/">« Pattern-Matching</a><a class="docs-footer-nextpage" href="../Combined/">Combined Strategies »</a><div class="flexbox-break"></div><p class="footer-message"><a href="https://github.com/shayandavoodii/OnlinePortfolioSelection.jl">OnlinePortfolioSelection.jl</a> v2.10.1 docs powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 9 February 2024 10:31">Friday 9 February 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
