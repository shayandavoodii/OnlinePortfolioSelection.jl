<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Combined Strategies · OnlinePortfolioSelection.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://shayandavoodii.github.io/OnlinePortfolioSelection.jl/Combined/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="OnlinePortfolioSelection.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">OnlinePortfolioSelection.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../fetchdata/">Fetch Financial Data</a></li><li><a class="tocitem" href="../python/">Use In Python</a></li><li><span class="tocitem">OPS Strategies</span><ul><li><a class="tocitem" href="../benchmark/">Benchmark</a></li><li><a class="tocitem" href="../FL/">Follow the Loser</a></li><li><a class="tocitem" href="../FW/">Follow the Winner</a></li><li><a class="tocitem" href="../PM/">Pattern-Matching</a></li><li><a class="tocitem" href="../ML/">Meta-Learning</a></li><li class="is-active"><a class="tocitem" href>Combined Strategies</a><ul class="internal"><li><a class="tocitem" href="#LOcal-ADaptive-learning-system-(LOAD)"><span>LOcal ADaptive learning system (LOAD)</span></a></li><li><a class="tocitem" href="#MRvol"><span>MRvol</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../performance_eval/">Performance Evaluation</a></li><li><a class="tocitem" href="../funcs/">Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">OPS Strategies</a></li><li class="is-active"><a href>Combined Strategies</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Combined Strategies</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/shayandavoodii/OnlinePortfolioSelection.jl/blob/main/docs/src/Combined.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h1><p>Nowadays researchers are trying to take advantage of each strategy and propose new methods that combine them. I plan to implement some of these methods in this package. A list of the methods that I&#39;ve implemented so far is as follows:</p><ol><li>LOcal ADaptive learning system (LOAD)</li><li>MRvol</li></ol><h2 id="LOcal-ADaptive-learning-system-(LOAD)"><a class="docs-heading-anchor" href="#LOcal-ADaptive-learning-system-(LOAD)">LOcal ADaptive learning system (LOAD)</a><a id="LOcal-ADaptive-learning-system-(LOAD)-1"></a><a class="docs-heading-anchor-permalink" href="#LOcal-ADaptive-learning-system-(LOAD)" title="Permalink"></a></h2><p><a href="https://doi.org/10.1016/j.knosys.2019.104958">Guan &amp; An (2019)</a> proposed a new OPS method, named LOcal ADaptive learning system (LOAD), which is a combination of the Follow the Winner (FW) and Follow the Loser principles. They tried to find the stocks that have a positive trend in the most recent time window by fitting a linear regression on the price data of the stocks against time. They used momentum principle to predict the next price of assets in this case. On the other hand, for the stocks that does not have a satisfactory trend in the most recent time window, they used the mean reversion principle to predict the next price of assets. They claim that through this fusion, the overall system can be more adaptive and effective than systems based on single strategies. After predicting the next prices, the next relative prices are predicted and used in the portfolio optimization.</p><h3 id="Run-LOAD"><a class="docs-heading-anchor" href="#Run-LOAD">Run LOAD</a><a id="Run-LOAD-1"></a><a class="docs-heading-anchor-permalink" href="#Run-LOAD" title="Permalink"></a></h3><p><strong>Note:</strong> This package is meant to be used by researchers <strong>NOT FOR MARKET PRACTITIONERS</strong>. Let&#39;s run the algorithm on the real market data.</p><pre><code class="language-julia hljs">julia&gt; using OnlinePortfolioSelection, YFinance

julia&gt; tickers = [&quot;AAPL&quot;, &quot;MSFT&quot;, &quot;AMZN&quot;];

julia&gt; startdt, enddt = &quot;2022-04-01&quot;, &quot;2023-04-27&quot;;

julia&gt; prices = [get_prices(ticker, startdt=startdt, enddt=enddt)[&quot;adjclose&quot;] for ticker in tickers];

julia&gt; prices = reduce(hcat, prices);

julia&gt; prices = prices |&gt; permutedims;

julia&gt; d_fac, window, horizon, eta = 0.5, 10, 5, 0.1;

julia&gt; model, St = load(prices, d_fac, window, horizon, eta);

# Get the portfolio weights
julia&gt; model.b
3×5 Matrix{Float64}:
 0.333333  2.65043e-10  1.65697e-8  0.669392  0.329286
 0.333333  1.0          1.0         0.330608  0.670714
 0.333333  0.0          0.0         0.0       0.0 

# Get the cumulative wealth of the portfolio over the trading period
julia&gt; St
6-element Vector{Float64}:
 1.0
 0.9937811173943497
 0.9925654837139548
 0.9787063658040356
 0.9652327928615669
 1.012107319760618</code></pre><p>The result indicates that if we had invested in the given period, we would have gained ~1.2% profit. Now, let&#39;s investiagte the performance of the algorithm according to some of the prominent metrics:</p><pre><code class="language-julia hljs">juli&gt; rel_price = prices[:, 2:end] ./ prices[:, 1:end-1];

julia&gt; metrics = OPSMetrics(model.b, rel_price)
            Cumulative Return: 1.0121073197606183
                          APY: 0.8340827024050514
Annualized Standard Deviation: 0.40329283437815505
      Annualized Sharpe Ratio: 2.0185895533212266
             Maximum Drawdown: 0.034767207138433065
                 Calmar Ratio: 23.990500562325092

julia&gt; metrics.Sn
6-element Vector{Float64}:
 1.0
 0.9937811173943497
 0.9925654837139548
 0.9787063658040356
 0.9652327928615669
 1.0121073197606183</code></pre><p>It is worht mentioning that each metric can be accessed individually by writing <code>results.</code> and pressing the <code>Tab</code> key. Note that one can individually investigate the performance of the algorithm regarding each metric. See <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{Matrix{T}, Matrix{T}}} where T&lt;:Float64"><code>sn</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_std-Tuple{Vector{Float64}}"><code>ann_std</code></a>, <a href="../funcs/#OnlinePortfolioSelection.apy-Union{Tuple{S}, Tuple{Float64, S}} where S&lt;:Int64"><code>apy</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_sharpe-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:Float64"><code>ann_sharpe</code></a>, <a href="../funcs/#OnlinePortfolioSelection.mdd-Union{Tuple{Vector{T}}, Tuple{T}} where T&lt;:Float64"><code>mdd</code></a>, and <a href="../funcs/#OnlinePortfolioSelection.calmar-Union{Tuple{T}, Tuple{T, T}} where T&lt;:Float64"><code>calmar</code></a>. See <a href="../performance_eval/#Performance-evaluation">Performance evaluation</a> section for more information.</p><h2 id="MRvol"><a class="docs-heading-anchor" href="#MRvol">MRvol</a><a id="MRvol-1"></a><a class="docs-heading-anchor-permalink" href="#MRvol" title="Permalink"></a></h2><p>Combination of meta-learning algorithms with other strategies are also investogated. For example, <a href="https://doi.org/10.1016/j.eswa.2023.121472">Lin et al. (2023)</a> proposed a new OPS method, named MRvol, which is a combination of the Follow the Loser (FL) and Meta-Learning (ML) strategies. First, they try to select the stocks that have the relative price bellow than 1 as the first filter, and then search for the stock that have the most relative volume value among the filtered stocks as the second filter. Then, they apply a meta-algorithm to integrate expert opinions (i.e., expert strategies), which are obtained based on mean reversion and trading volume. Thirdly, they determine the window size of the expert strategy as W and establish an expert strategy. When the expert constructs a stock portfolio, he/she identifies an investment target asset for each period, so there are W investment target assets. As they said, in order to reduce investment risk and increase diversification of investment, this paper considers using moving window data of different sizes to construct a pool of expert strategies, which is also called a pool of expert opinions, and then applies meta-algorithm in machine learning technique to integrate expert opinions to propose an investment strategy.</p><h3 id="Run-MRvol"><a class="docs-heading-anchor" href="#Run-MRvol">Run MRvol</a><a id="Run-MRvol-1"></a><a class="docs-heading-anchor-permalink" href="#Run-MRvol" title="Permalink"></a></h3><p>Let&#39;s run the algorithm on the real market data.</p><pre><code class="language-julia hljs">julia&gt; using OnlinePortfolioSelection, YFinance

julia&gt; tickers = [&quot;AAPL&quot;, &quot;MSFT&quot;, &quot;GOOG&quot;];

julia&gt; startdt, enddt = &quot;2019-01-01&quot;, &quot;2020-01-01&quot;;

julia&gt; querry_open_price = [get_prices(ticker, startdt=startdt, enddt=enddt)[&quot;open&quot;] for ticker in tickers];

julia&gt; open_pr = reduce(hcat, querry_open_price) |&gt; permutedims;

julia&gt; querry_close_pr = [get_prices(ticker, startdt=startdt, enddt=enddt)[&quot;adjclose&quot;] for ticker in tickers];

julia&gt; close_pr = reduce(hcat, querry_close_pr) |&gt; permutedims;

julia&gt; querry_vol = [get_prices(ticker, startdt=startdt, enddt=enddt)[&quot;vol&quot;] for ticker in tickers];

julia&gt; vol = reduce(hcat, querry_vol) |&gt; permutedims;

julia&gt; rel_pr = (close_pr ./ open_pr)[:, 2:end];

julia&gt; rel_vol = vol[:, 2:end] ./ vol[:, 1:end-1];

julia&gt; size(rel_pr) == size(rel_vol)
true

julia&gt; horizon = 100; Wₘᵢₙ = 4; Wₘₐₓ = 10; λ = 0.05; η = 0.01;

julia&gt; r = mrvol(rel_pr, rel_vol, horizon, Wₘᵢₙ, Wₘₐₓ, λ, η);

julia&gt; r.b
3×100 Matrix{Float64}:
 0.333333  0.0204062  0.0444759   …   0.38213   0.467793      
 0.333333  0.359864   0.194139        0.213264  0.281519
 0.333333  0.61973    0.761385        0.404606  0.250689

julia&gt; sum(r.b, dims=1) .|&gt; isapprox(1.0) |&gt; all
true</code></pre><p>Now, let&#39;s investiagte the performance of the algorithm according to some of the prominent metrics:</p><pre><code class="language-julia hljs">julia&gt; metrics = OPSMetrics(r.b, rel_pr)
            Cumulative Return: 1.0277067897356449
                          APY: 0.07129838196490379
Annualized Standard Deviation: 0.1224831726093685
      Annualized Sharpe Ratio: 0.41881983354977265
             Maximum Drawdown: 0.0692690958483587
                 Calmar Ratio: 1.0292956922808336

julia&gt; metrics.Sn
101-element Vector{Float64}:
 1.0
 0.9945454662509302
 0.9889386321026037
 1.0108661401532446
 ⋮
 1.0219508111711197
 1.0185657113697373
 1.0277067897356449</code></pre><p>The result of <code>metrics.Sn</code> indicates that if we had invested in the given period, we would have gained ~2.8% profit. It is worht mentioning that each metric can be accessed individually by writing <code>results.</code> and pressing the <code>Tab</code> key. Note that one can individually investigate the performance of the algorithm regarding each metric. See <a href="../funcs/#OnlinePortfolioSelection.sn-Union{Tuple{T}, Tuple{Matrix{T}, Matrix{T}}} where T&lt;:Float64"><code>sn</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_std-Tuple{Vector{Float64}}"><code>ann_std</code></a>, <a href="../funcs/#OnlinePortfolioSelection.apy-Union{Tuple{S}, Tuple{Float64, S}} where S&lt;:Int64"><code>apy</code></a>, <a href="../funcs/#OnlinePortfolioSelection.ann_sharpe-Union{Tuple{T}, Tuple{T, T, T}} where T&lt;:Float64"><code>ann_sharpe</code></a>, <a href="../funcs/#OnlinePortfolioSelection.mdd-Union{Tuple{Vector{T}}, Tuple{T}} where T&lt;:Float64"><code>mdd</code></a>, and <a href="../funcs/#OnlinePortfolioSelection.calmar-Union{Tuple{T}, Tuple{T, T}} where T&lt;:Float64"><code>calmar</code></a>. See <a href="../performance_eval/#Performance-evaluation">Performance evaluation</a> section for more information.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ML/">« Meta-Learning</a><a class="docs-footer-nextpage" href="../performance_eval/">Performance Evaluation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 17 October 2023 11:12">Tuesday 17 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
