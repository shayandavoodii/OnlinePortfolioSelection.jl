<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Use In Python · OnlinePortfolioSelection.jl</title><meta name="title" content="Use In Python · OnlinePortfolioSelection.jl"/><meta property="og:title" content="Use In Python · OnlinePortfolioSelection.jl"/><meta property="twitter:title" content="Use In Python · OnlinePortfolioSelection.jl"/><meta name="description" content="Documentation for OnlinePortfolioSelection.jl."/><meta property="og:description" content="Documentation for OnlinePortfolioSelection.jl."/><meta property="twitter:description" content="Documentation for OnlinePortfolioSelection.jl."/><meta property="og:url" content="https://shayandavoodii.github.io/OnlinePortfolioSelection.jl/python/"/><meta property="twitter:url" content="https://shayandavoodii.github.io/OnlinePortfolioSelection.jl/python/"/><link rel="canonical" href="https://shayandavoodii.github.io/OnlinePortfolioSelection.jl/python/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="OnlinePortfolioSelection.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">OnlinePortfolioSelection.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../fetchdata/">Fetch Financial Data</a></li><li class="is-active"><a class="tocitem" href>Use In Python</a><ul class="internal"><li><a class="tocitem" href="#juliacall"><span>juliacall</span></a></li><li><a class="tocitem" href="#Pyjulia"><span>Pyjulia</span></a></li><li class="toplevel"><a class="tocitem" href="#Run-[MRvol](@ref)-Algorithm"><span>Run MRvol Algorithm</span></a></li><li class="toplevel"><a class="tocitem" href="#Run-[ClusLog](@ref)-Algorithm"><span>Run ClusLog Algorithm</span></a></li></ul></li><li><span class="tocitem">OPS Strategies</span><ul><li><a class="tocitem" href="../benchmark/">Benchmark</a></li><li><a class="tocitem" href="../FL/">Follow the Loser</a></li><li><a class="tocitem" href="../FW/">Follow the Winner</a></li><li><a class="tocitem" href="../PM/">Pattern-Matching</a></li><li><a class="tocitem" href="../ML/">Meta-Learning</a></li><li><a class="tocitem" href="../Combined/">Combined Strategies</a></li></ul></li><li><a class="tocitem" href="../performance_eval/">Performance Evaluation</a></li><li><a class="tocitem" href="../funcs/">Functions</a></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../refs/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Use In Python</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Use In Python</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/shayandavoodii/OnlinePortfolioSelection.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/shayandavoodii/OnlinePortfolioSelection.jl/blob/main/docs/src/python.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Use-OnlinePortfolioSelection.jl-in-Python"><a class="docs-heading-anchor" href="#Use-OnlinePortfolioSelection.jl-in-Python">Use <code>OnlinePortfolioSelection.jl</code> in Python</a><a id="Use-OnlinePortfolioSelection.jl-in-Python-1"></a><a class="docs-heading-anchor-permalink" href="#Use-OnlinePortfolioSelection.jl-in-Python" title="Permalink"></a></h1><p>There are two prominent packages that facilitate using Julia packages in Python environment:</p><ol><li><a href="#juliacall">juliacall</a></li><li><a href="#Pyjulia">Pyjulia</a></li></ol><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It is recommended to use juliacall since it is more stable according to one of active julia developers [<a href="https://stackoverflow.com/questions/77264168/importerror-pkg-name-not-found-in-importing-a-julia-package-in-python-using-p#comment136214601_77264168">1</a>].</p></div></div><h2 id="juliacall"><a class="docs-heading-anchor" href="#juliacall">juliacall</a><a id="juliacall-1"></a><a class="docs-heading-anchor-permalink" href="#juliacall" title="Permalink"></a></h2><p>To use <a href="https://github.com/JuliaPy/PythonCall.jl"><code>juliacall</code></a>, simply install it using <code>pip install juliacall</code> and then follow the subsequent steps to use <code>OnlinePortfolioSelection.jl</code> in Python (keep in mind that I&#39;ve truncated the long outputs to avoid a lengthy documentation):</p><pre><code class="language-python hljs">&gt;&gt;&gt; from juliacall import Main as jl
&gt;&gt;&gt; jl.Pkg.add(&quot;OnlinePortfolioSelection&quot;)

&gt;&gt;&gt; # Confirm the installation using the following command
&gt;&gt;&gt; jl.Pkg.status()
Status `C:\Users\Shayan\miniconda3\envs\im\julia_env\Project.toml`
  [038f9fe3] OnlinePortfolioSelection v2.10.1
  [6099a3de] PythonCall v0.9.15

&gt;&gt;&gt; # And then use the package
&gt;&gt;&gt; jl.seval(&quot;using OnlinePortfolioSelection&quot;)
&gt;&gt;&gt; jl.opsmethods()

      ===== OnlinePortfolioSelection.jl =====
            Currently available methods
       =====================================

        UP: Universal Portfolio - Call `up`
        EG: Exponential Gradient - Call `eg`
     CORNU: CORN-U - Call `cornu`
     CORNK: CORN-K - Call `cornk`
     ⋮

&gt;&gt;&gt; # Run the following command in order to get the documentation of `sspo` function
&gt;&gt;&gt; jl.Docs.doc(jl.sspo)
Julia:
  sspo(
    p::AbstractMatrix,
    horizon::Integer,
    w::Integer,
    b̂ₜ::Union{Nothing, AbstractVector}=nothing,
    η::AbstractFloat=0.005,
    γ::AbstractFloat=0.01,
    λ::AbstractFloat=0.5,
    ζ::Integer=500,
    ϵ::AbstractFloat=1e-4,
    max_iter=1e4
  )


  Run Short-term Sparse Portfolio Optimization (SSPO) algorithm.

  Arguments
  ≡≡≡≡≡≡≡≡≡

    •  p::AbstractMatrix: Prices of the assets.

    •  horizon::Integer: Number of investment periods.
    ⋮</code></pre><p>Now that you know how to import the package in Python, let&#39;s run the <a href="../FW/#Short-term-Sparse-Portfolio-Optimization-(SSPO)">sspo</a> algorithm in Python:</p><pre><code class="language-python hljs">&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; prices = np.random.rand(4, 80)
&gt;&gt;&gt; model = jl.sspo(
...   prices,
...   6,
...   5,
...   jl.nothing,
...   0.003
... )

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

&gt;&gt;&gt; model
Julia: OPSAlgorithm{Float64}(4, [0.25 0.0 … 0.0 0.0; 0.25 0.0 … 0.0 0.9999990246207479; 0.25 9.948297404456596e-9 … 0.0 0.0; 0.25 0.9999999900517027 … 1.0 9.75379252201141e-7], &quot;SSPO&quot;)
&gt;&gt;&gt; model.b
Julia:
4×6 Matrix{Float64}:
 0.25  0.0        0.0         0.0         0.0  0.0
 0.25  0.0        1.0         9.92937e-9  0.0  0.999999
 0.25  9.9483e-9  9.93036e-9  0.0         0.0  0.0
 0.25  1.0        0.0         1.0         1.0  9.75379e-7</code></pre><p>Hence, you can access the weights that are obtined by the algorithm using the <code>b</code> attribute of the <code>model</code> object. You can also access the algorithm name using the <code>alg</code> attribute of the <code>model</code> object:</p><pre><code class="language-python hljs">&gt;&gt;&gt; model.alg
&#39;SSPO&#39;</code></pre><p>Refer to the <a href="../types/#OnlinePortfolioSelection.OPSAlgorithm"><code>OPSAlgorithm</code></a> documentation for more details about the attributes of the <code>model</code> object.</p><h2 id="Pyjulia"><a class="docs-heading-anchor" href="#Pyjulia">Pyjulia</a><a id="Pyjulia-1"></a><a class="docs-heading-anchor-permalink" href="#Pyjulia" title="Permalink"></a></h2><p>Generally, Julia packages can be used in a Python environment with ease by employing wrapper packages that facilitate the translation of Julia functionalities into Python. A notable package in this domain is <a href="https://pyjulia.readthedocs.io/en/latest/index.html">PyJulia</a>. Comprehensive installation guidelines can be found in the <a href="https://pyjulia.readthedocs.io/en/latest/installation.html">PyJulia documentation</a>. To leverage Julia packages in Python, previously discussed methods have covered importing Julia code into Python (<a href="https://stackoverflow.com/q/73070845/11747148">2</a>, <a href="https://blog.esciencecenter.nl/how-to-call-julia-code-from-python-8589a56a98f2">3</a>). In this section, I&#39;ll demonstrate how to utilize <code>OnlinePortfolioSelection.jl</code> in Python. For resolution of potential issues during package importation, please refer to <a href="https://stackoverflow.com/questions/77264168/importerror-pkg-name-not-found-in-importing-a-julia-package-in-python-using-p">this</a> discussion.</p><ol><li>Begin by installing PyJulia via <code>pip install julia</code>. Ensure that the Julia path is added to the system environment variable <code>PATH</code>, enabling the usage of <code>julia</code> from the command line. Typically, the Julia path is found in <code>\.julia\juliaup\julia-&lt;VERSION&gt;\bin</code> or <code>C:\Users\your-user-name\AppData\Local\Programs\Julia\Julia-&lt;VERSION&gt;\bin</code>.</li><li>Launch Python.</li><li>Execute the subsequent commands in Python.</li></ol><pre><code class="language-python hljs">&gt;&gt;&gt; from julia import Pkg
&gt;&gt;&gt; Pkg.add(&quot;OnlinePortfolioSelection&quot;)
&gt;&gt;&gt; from julia import OnlinePortfolioSelection as OPS</code></pre><h1 id="Run-[MRvol](@ref)-Algorithm"><a class="docs-heading-anchor" href="#Run-[MRvol](@ref)-Algorithm">Run <a href="../Combined/#MRvol">MRvol</a> Algorithm</a><a id="Run-[MRvol](@ref)-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Run-[MRvol](@ref)-Algorithm" title="Permalink"></a></h1><p>In this instance, I&#39;m demonstrating the execution of the <a href="../Combined/#MRvol">MRvol</a> algorithm.</p><pre><code class="language-python hljs"># Generate a random relatvive price matrix. The rows are the assets, and the columns represent the time.
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; rel_pr = np.random.rand(3, 100)
&gt;&gt;&gt; rel_vol = np.random.rand(3, 100)
&gt;&gt;&gt; horizon, Wmin, Wmax, lambdaa, eta = (10, 4, 10, 0.05, 0.01)
&gt;&gt;&gt; model = OPS.mrvol(rel_pr, rel_vol, horizon, Wmin, Wmax, lambdaa, eta)
&gt;&gt;&gt; type(model)
&lt;class &#39;PyCall.jlwrap&#39;&gt;
&gt;&gt;&gt; model.b
array([[0.33333333, 0.36104291, 0.3814967 , 0.26303273, 0.16525094,
        0.23471654, 0.28741473, 0.34746891, 0.41769629, 0.34582386],
      [0.33333333, 0.35745995, 0.24895616, 0.30306051, 0.36527706,
        0.2817696 , 0.36959982, 0.43371551, 0.48357232, 0.51374896],
      [0.33333333, 0.28149714, 0.36954713, 0.43390676, 0.469472  ,
        0.48351386, 0.34298546, 0.21881558, 0.09873139, 0.14042718]])
&gt;&gt;&gt; type(model.b)
&lt;class &#39;numpy.ndarray&#39;&gt;
&gt;&gt;&gt; model.b.sum(axis=0)
array([1., 1., 1., 1., 1., 1., 1., 1., 1., 1.])
&gt;&gt;&gt; model.alg
&#39;MRvol&#39;
&gt;&gt;&gt; model.n_assets
3</code></pre><p>As demonstrated, the <a href="../funcs/#OnlinePortfolioSelection.mrvol-Union{Tuple{S}, Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}, S, S, S, T, T}} where {T&lt;:AbstractFloat, S&lt;:Integer}"><code>mrvol</code></a> function returns a <code>PyCall.jlwrap</code> object. Access the portfolio weights through <code>model.b</code>, automatically converted into a <code>numpy.ndarray</code>. Similarly, other attributes of the <code>model</code> object can be accessed. To inspect the attributes of the <code>model</code> object further, refer to the documentation for the returned object via the <a href="../funcs/#OnlinePortfolioSelection.mrvol-Union{Tuple{S}, Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}, S, S, S, T, T}} where {T&lt;:AbstractFloat, S&lt;:Integer}"><code>mrvol</code></a> function. Now, proceed to calculate the algorithm&#39;s performance based on notable metrics:</p><pre><code class="language-python hljs">&gt;&gt;&gt; metrics = OPS.opsmetrics(model.b, rel_pr)
&gt;&gt;&gt; metrics

&lt;PyCall.jlwrap             Cumulative Return: 0.0003879435247256176
                          APY: -1.0
Annualized Standard Deviation: 2.7595804965778328
      Annualized Sharpe Ratio: -0.36962139762362656
             Maximum Drawdown: 0.9996120564752744
                 Calmar Ratio: -1.0003880940833123

&gt;&gt;&gt; metrics.Sn
array([1.00000000e+00, 5.75525607e-01, 1.45701657e-01, 7.12853019e-02,
       4.30702987e-02, 2.03865521e-02, 1.53802433e-02, 7.10270166e-03,
       1.97878448e-03, 8.65966074e-04, 3.87943525e-04])</code></pre><p>As observed, the <a href="../funcs/#OnlinePortfolioSelection.opsmetrics-Union{Tuple{S}, Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}, AbstractVector{T}}} where {T&lt;:AbstractFloat, S&lt;:Int64}"><code>opsmetrics</code></a> function returns a <code>PyCall.jlwrap</code> object. The cumulative wealth of portfolios is accessable through <code>metrics.Sn</code>, automatically converted into a <code>numpy.ndarray</code>. Other attributes of the <code>metrics</code> object can be accessed similarly. To further explore the attributes of the <code>metrics</code> object, review the documentation for the returned object using the <a href="../funcs/#OnlinePortfolioSelection.opsmetrics-Union{Tuple{S}, Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}, AbstractVector{T}}} where {T&lt;:AbstractFloat, S&lt;:Int64}"><code>opsmetrics</code></a> function. Additionally, documentation for each function can be accessed through Python. For instance, you can retrieve the documentation for the <a href="../funcs/#OnlinePortfolioSelection.mrvol-Union{Tuple{S}, Tuple{T}, Tuple{AbstractMatrix{T}, AbstractMatrix{T}, S, S, S, T, T}} where {T&lt;:AbstractFloat, S&lt;:Integer}"><code>mrvol</code></a> function by executing the following commands:</p><pre><code class="language-python hljs">&gt;&gt;&gt; from julia import Main as jl
&gt;&gt;&gt; jl.Docs.doc(OPS.mrvol)
&lt;PyCall.jlwrap mrvol(       rel*pr::AbstractMatrix{T},       rel*vol::AbstractMatrix{T},       horizon::S,       Wₘᵢₙ::S,       Wₘₐₓ::S,       λ::T,       η::T     ) where {T&lt;:AbstractFloat, S&lt;:Integer}

Run MRvol algorithm.

# Arguments

  * `rel_pr::AbstractMatrix{T}`: Relative price matrix where it represents proportion of the closing price to the opening price of each asset in each day.
  * `rel_vol::AbstractMatrix{T}`: Relative volume matrix where 𝘷ᵢⱼ represents the tᵗʰ trading volume of asset 𝑖 divided by the (t - 1)ᵗʰ trading volume of asset 𝑖.
  * `horizon::S`: Investment horizon. The last `horizon` days of the data will be used to run the algorithm.
  * `Wₘᵢₙ::S`: Minimum window size.
  * `Wₘₐₓ::S`: Maximum window size.
  * `λ::T`: Trade-off parameter in the loss function.
  * `η::T`: Learning rate.

# Returns

  * `OPSAlgorithm`: An [`OPSAlgorithm`](@ref) object.

# Example

...</code></pre><h1 id="Run-[ClusLog](@ref)-Algorithm"><a class="docs-heading-anchor" href="#Run-[ClusLog](@ref)-Algorithm">Run <a href="../PM/#ClusLog">ClusLog</a> Algorithm</a><a id="Run-[ClusLog](@ref)-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Run-[ClusLog](@ref)-Algorithm" title="Permalink"></a></h1><p>Another example can be using <a href="../funcs/#OnlinePortfolioSelection.cluslog"><code>cluslog</code></a> function to perform &#39;KMNLOG&#39; or &#39;KMDLOG&#39; model (see <a href="../PM/#ClusLog">ClusLog</a>, <a href="../types/#OnlinePortfolioSelection.KMNLOG"><code>KMNLOG</code></a>, and <a href="../types/#OnlinePortfolioSelection.KMDLOG"><code>KMDLOG</code></a> for more details):</p><pre><code class="language-python hljs"># before running the following code, please read the
# instruction to install Julia package in Python that is
# described in the beginning of this page.
&gt;&gt;&gt; from julia import Main as jl
&gt;&gt;&gt; from julia import OnlinePortfolioSelection as OPS
# In order to use `cluslog` algorithm, you need to install `Clustering` package in Julia.
&gt;&gt;&gt; from julia import Pkg
&gt;&gt;&gt; Pkg.add(name=&quot;Clustering&quot;, version=&quot;0.15.2&quot;)
&gt;&gt;&gt; from julia import Clustering

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; rel_pr = np.random.rand(3, 150)
&gt;&gt;&gt; horizon, max_tw_len, clustering_model = 50, 10, OPS.KMNLOG
&gt;&gt;&gt; max_n_clus, max_n_clustering, asset_bounderies = 10, 10, (0., 1.)
&gt;&gt;&gt; model = OPS.cluslog(rel_pr, horizon, max_tw_len, clustering_model, max_n_clus, max_n_clustering, asset_bounderies)
█████████████████████████████████████┫ 100.0% |50/50
# The weights of the portfolios are stored in `model.b`.
&gt;&gt;&gt; model.b.sum(axis=0)
array([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
       1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
       1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.])</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../fetchdata/">« Fetch Financial Data</a><a class="docs-footer-nextpage" href="../benchmark/">Benchmark »</a><div class="flexbox-break"></div><p class="footer-message"><a href="https://github.com/shayandavoodii/OnlinePortfolioSelection.jl">OnlinePortfolioSelection.jl</a> v2.10.1 docs powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Wednesday 24 January 2024 18:17">Wednesday 24 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
